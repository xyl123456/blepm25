###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.3.10338/W32 for 8051         31/Aug/2017  19:29:46 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  E:\PM2.5\Projects\zstack\Samples\GenericApp\Source #
#                          \sht10.c                                           #
#    Command line       =  -f E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2 #
#                          530DB\..\..\..\Tools\CC2530DB\f8wCoord.cfg         #
#                          (-DCPU32MHZ -DROOT=__near_func                     #
#                          -DMAC_CFG_APP_PENDING_QUEUE=TRUE                   #
#                          -DZDO_COORDINATOR -DRTR_NWK -DBLINK_LEDS) -f       #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\Tools\CC2530DB\f8wConfig.cfg           #
#                          (-DSECURE=0 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR      #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116 "-DCONST=const __code"    #
#                          -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE     #
#                          -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100            #
#                          -DRESPONSE_POLL_RATE=100) -DREJOIN_POLL_RATE=440   #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\Source #
#                          \sht10.c -D ZIGBEEPRO -D ZTOOL_P1 -D xMT_TASK -D   #
#                          xMT_SYS_FUNC -D xMT_ZDO_FUNC -D                    #
#                          LCD_SUPPORTED=DEBUG -lC E:\PM2.5\Projects\zstack\S #
#                          amples\GenericApp\CC2530DB\CoordinatorEB-Pro\List\ #
#                           -lA E:\PM2.5\Projects\zstack\Samples\GenericApp\C #
#                          C2530DB\CoordinatorEB-Pro\List\ --diag_suppress    #
#                          Pe001,Pa010 -o E:\PM2.5\Projects\zstack\Samples\Ge #
#                          nericApp\CC2530DB\CoordinatorEB-Pro\Obj\ -e        #
#                          --debug --core=plain --dptr=16,1                   #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2 #
#                          530DB\ -I E:\PM2.5\Projects\zstack\Samples\Generic #
#                          App\CC2530DB\..\SOURCE\ -I                         #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\ZMAIN\TI2530DB\ -I                     #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\MT\ -I                #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\HAL\INCLUDE\ -I       #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\HAL\TARGET\CC2530EB\  #
#                          -I E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2 #
#                          530DB\..\..\..\..\..\COMPONENTS\OSAL\MCU\CCSOC\    #
#                          -I E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2 #
#                          530DB\..\..\..\..\..\COMPONENTS\OSAL\INCLUDE\ -I   #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\STACK\AF\ -I          #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\STACK\NWK\ -I         #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\STACK\SEC\ -I         #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\STACK\SAPI\ -I        #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\STACK\SYS\ -I         #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\STACK\ZDO\ -I         #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\ZMAC\F8W\ -I          #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\ZMAC\ -I              #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\SERVICES\SADDR\ -I    #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\SERVICES\SDATA\ -I    #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\MAC\INCLUDE\ -I       #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\MAC\HIGH_LEVEL\ -I    #
#                          E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\..\..\..\..\..\COMPONENTS\MAC\LOW_LEVEL\srf04\  #
#                          -I E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2 #
#                          530DB\..\..\..\..\..\COMPONENTS\MAC\LOW_LEVEL\srf0 #
#                          4\SINGLE_CHIP\ -Ohz --require_prototypes           #
#    List file          =  E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\CoordinatorEB-Pro\List\sht10.lst                #
#    Object file        =  E:\PM2.5\Projects\zstack\Samples\GenericApp\CC2530 #
#                          DB\CoordinatorEB-Pro\Obj\sht10.r51                 #
#                                                                             #
#                                                                             #
###############################################################################

E:\PM2.5\Projects\zstack\Samples\GenericApp\Source\sht10.c
      1          #include "sht10.h"

   \                                 In  segment SFR_AN, at 0x80
   \   union <unnamed> volatile __sfr _A_P0
   \                     _A_P0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf3
   \   unsigned char volatile __sfr P0SEL
   \                     P0SEL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfd
   \   unsigned char volatile __sfr P0DIR
   \                     P0DIR:
   \   000000                DS 1

   \                                 In  segment XDATA_Z, align 1, keep-with-next
      2          struct SHT11_DATA_STAUCT  SHT11;
   \                     SHT11:
   \   000000                DS 18
   \   000012                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
      3          static unsigned char flag = 0;
   \                     flag:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
      4          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
      5          void SHT11_Delay(unsigned char us)
   \                     SHT11_Delay:
      6          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
   \   000000   8008         SJMP    ??SHT11_Delay_0
      7          	while(us--)
      8          	{
      9          		asm("NOP");
   \                     ??SHT11_Delay_1:
   \   000002   00           NOP
     10          		asm("NOP");
   \   000003   00           NOP
     11          		asm("NOP");
   \   000004   00           NOP
     12          		asm("NOP");
   \   000005   00           NOP
     13          		asm("NOP");
   \   000006   00           NOP
     14          		asm("NOP");
   \   000007   00           NOP
     15          		asm("NOP");
   \   000008   00           NOP
     16          		asm("NOP");
   \   000009   00           NOP
     17          	}
   \                     ??SHT11_Delay_0:
   \   00000A   E9           MOV     A,R1
   \   00000B   F8           MOV     R0,A
   \   00000C   74FF         MOV     A,#-0x1
   \   00000E   28           ADD     A,R0
   \   00000F   19           DEC     R1
   \   000010   04           INC     A
   \   000011   70EF         JNZ     ??SHT11_Delay_1
     18          }
   \   000013   02....       LJMP    ?BRET
     19          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     20          void SHT11_Delay_Ms(unsigned char ms)
   \                     SHT11_Delay_Ms:
     21          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FF           MOV     R7,A
     22          	unsigned char i;
     23          	for(i=0;i<ms;i++)
   \   000007   7E00         MOV     R6,#0x0
   \   000009   8007         SJMP    ??SHT11_Delay_Ms_0
     24          	{
     25          	SHT11_Delay(250);
   \                     ??SHT11_Delay_Ms_1:
   \   00000B                ; Setup parameters for call to function SHT11_Delay
   \   00000B   12....       LCALL   ?Subroutine4 & 0xFFFF
     26          	SHT11_Delay(250);
     27          	SHT11_Delay(250);
   \                     ??CrossCallReturnLabel_2:
   \   00000E                ; Setup parameters for call to function SHT11_Delay
   \   00000E   12....       LCALL   ?Subroutine4 & 0xFFFF
     28          	SHT11_Delay(250);
     29          	}
   \                     ??CrossCallReturnLabel_3:
   \   000011   0E           INC     R6
   \                     ??SHT11_Delay_Ms_0:
   \   000012   EE           MOV     A,R6
   \   000013   C3           CLR     C
   \   000014   9F           SUBB    A,R7
   \   000015   40F4         JC      ??SHT11_Delay_Ms_1
     30          }
   \   000017                REQUIRE ?Subroutine1
   \   000017                ; // Fall through to label ?Subroutine1

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   7F01         MOV     R7,#0x1
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   79FA         MOV     R1,#-0x6
   \   000002   12....       LCALL   ??SHT11_Delay?relay
   \   000005                ; Setup parameters for call to function SHT11_Delay
   \   000005                ; Setup parameters for call to function SHT11_Delay
   \   000005                ; Setup parameters for call to function SHT11_Delay
   \   000005   79FA         MOV     R1,#-0x6
   \   000007   12....       LCALL   ??SHT11_Delay?relay
   \   00000A   22           RET
     31          
     32          /********************
     33          *数据线依次输入1  0  表示启动
     34          时钟的时序为时钟线拉低再拉高
     35          *********************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     36          void SHT11_Start(void)
   \                     SHT11_Start:
     37          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
     38          	SHT11_DATA_OUT;//数据为输出模式
   \   000004   43FD40       ORL     0xfd,#0x40
     39          /*-------------------1--------------*/
     40          	SHT11_DATA  = 1;//数据为1
   \   000007   D286         SETB    0x80.6
     41          
     42          	SHT11_SCL_RESET;//scl=0
   \   000009   C287         CLR     0x80.7
     43          	SHT11_Delay(5);
   \   00000B                ; Setup parameters for call to function SHT11_Delay
   \   00000B   7905         MOV     R1,#0x5
   \   00000D   12....       LCALL   ??SHT11_Delay?relay
     44          	SHT11_SCL_SET;//scl =1
   \   000010   D287         SETB    0x80.7
     45          	
     46          	SHT11_Delay(1);
   \   000012                ; Setup parameters for call to function SHT11_Delay
   \   000012   7901         MOV     R1,#0x1
   \   000014   12....       LCALL   ??SHT11_Delay?relay
     47          /*-------------------0--------------*/
     48          	SHT11_DATA =0;//数据为0
   \   000017   C286         CLR     0x80.6
     49          	SHT11_SCL_RESET;//scl=0
   \   000019   C287         CLR     0x80.7
     50          	SHT11_Delay(5);
   \   00001B                ; Setup parameters for call to function SHT11_Delay
   \   00001B   7905         MOV     R1,#0x5
   \   00001D   12....       LCALL   ??SHT11_Delay?relay
     51          	SHT11_SCL_SET;//scl=1
   \   000020   D287         SETB    0x80.7
     52          
     53          	SHT11_DATA = 1;//SDA=1
   \   000022   D286         SETB    0x80.6
     54          	SHT11_SCL_RESET;//SCL=0
   \   000024   C287         CLR     0x80.7
     55          	
     56          }
   \   000026                REQUIRE ?Subroutine0
   \   000026                REQUIRE P0DIR
   \   000026                REQUIRE _A_P0
   \   000026                ; // Fall through to label ?Subroutine0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   D083         POP     DPH
   \   000002   D082         POP     DPL
   \   000004   02....       LJMP    ?BRET
     57          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     58          void SHT11_Reset(void)
   \                     SHT11_Reset:
     59          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
     60          	unsigned char i;
     61          	SHT11_DATA_OUT;//输出模式
   \   000004   43FD40       ORL     0xfd,#0x40
     62          	SHT11_DATA=1;
   \   000007   D286         SETB    0x80.6
     63          	asm("NOP");
   \   000009   00           NOP
     64          	SHT11_SCL_RESET;
   \   00000A   C287         CLR     0x80.7
     65          	asm("NOP");
   \   00000C   00           NOP
     66          	for(i=0;i<9;i++)
   \   00000D   7409         MOV     A,#0x9
     67          	{
     68          		SHT11_SCL_SET;
   \                     ??SHT11_Reset_0:
   \   00000F   D287         SETB    0x80.7
     69          		asm("NOP");
   \   000011   00           NOP
     70          		SHT11_SCL_RESET;
   \   000012   C287         CLR     0x80.7
     71          		asm("NOP");
   \   000014   00           NOP
     72          	}
   \   000015   14           DEC     A
   \   000016   70F7         JNZ     ??SHT11_Reset_0
     73          	SHT11_Start();//启动SHT11
   \   000018                ; Setup parameters for call to function SHT11_Start
   \   000018   12....       LCALL   ??SHT11_Start?relay
     74          	
     75          }
   \   00001B   80..         SJMP    ?Subroutine0
   \   00001D                REQUIRE P0DIR
   \   00001D                REQUIRE _A_P0
     76          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     77          unsigned char SHT11_Write_Byte(unsigned char byte)
   \                     SHT11_Write_Byte:
     78          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FF           MOV     R7,A
     79          		unsigned char i;
     80          		unsigned char status =1;//状态
     81          		SHT11_DATA_OUT;//数据输出模式
   \   000007   43FD40       ORL     0xfd,#0x40
     82          		for(i=0;i<8;i++)
   \   00000A   7E08         MOV     R6,#0x8
     83          		{
     84          		//一个字节由高位到低位写入SHT11
     85          		if((byte & 0x80)==0x80) 
   \                     ??SHT11_Write_Byte_0:
   \   00000C   EF           MOV     A,R7
   \   00000D   A2E7         MOV     C,0xE0 /* A   */.7
   \   00000F   5004         JNC     ??SHT11_Write_Byte_1
     86          			SHT11_DATA =1;
   \   000011   D286         SETB    0x80.6
   \   000013   8002         SJMP    ??SHT11_Write_Byte_2
     87          		else
     88          			SHT11_DATA =0;
   \                     ??SHT11_Write_Byte_1:
   \   000015   C286         CLR     0x80.6
     89          		//拉高时钟线,延时5US,脉冲写入
     90          		SHT11_SCL_SET;
   \                     ??SHT11_Write_Byte_2:
   \   000017   D287         SETB    0x80.7
     91          		SHT11_Delay(5);
   \   000019                ; Setup parameters for call to function SHT11_Delay
   \   000019   7905         MOV     R1,#0x5
   \   00001B   12....       LCALL   ??SHT11_Delay?relay
     92          		SHT11_SCL_RESET;
   \   00001E   C287         CLR     0x80.7
     93          		byte <<=1;
   \   000020   EF           MOV     A,R7
   \   000021   C3           CLR     C
   \   000022   33           RLC     A
   \   000023   FF           MOV     R7,A
     94          		}
   \   000024   1E           DEC     R6
   \   000025   EE           MOV     A,R6
   \   000026   70E4         JNZ     ??SHT11_Write_Byte_0
     95          		SHT11_DATA =1;//释放数据线
   \   000028   D286         SETB    0x80.6
     96          		SHT11_DATA_IN;//输入模式，未接收准备
   \   00002A   53FDBF       ANL     0xfd,#0xbf
     97          		SHT11_SCL_SET;//scl=1
   \   00002D   D287         SETB    0x80.7
     98          		status = SHT11_DATA;//接收应答
   \   00002F   E580         MOV     A,0x80
     99          		//默认状态
    100          		SHT11_SCL_RESET;//拉低
   \   000031   C287         CLR     0x80.7
    101          		if(status == 0)
   \   000033   A2E6         MOV     C,0xE0 /* A   */.6
   \   000035   4004         JC      ??SHT11_Write_Byte_3
    102          			{
    103          			return SUCCESS_1;
   \   000037   7901         MOV     R1,#0x1
   \   000039   8002         SJMP    ??SHT11_Write_Byte_4
    104          			}
    105          		else
    106          			{
    107          			return ERROR;
   \                     ??SHT11_Write_Byte_3:
   \   00003B   7902         MOV     R1,#0x2
    108          			}		
   \                     ??SHT11_Write_Byte_4:
   \   00003D   02....       LJMP    ?Subroutine1 & 0xFFFF
   \   000040                REQUIRE P0DIR
   \   000040                REQUIRE _A_P0
    109          }
    110          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    111          char SHT11_Read_Byte(unsigned char ack_status)
   \                     SHT11_Read_Byte:
    112          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 0,R1
    113          	unsigned char i;
    114          	unsigned char byte =0;
   \   000007   7E00         MOV     R6,#0x0
    115          	SHT11_DATA_IN;//输入模式
   \   000009   53FDBF       ANL     0xfd,#0xbf
    116          	for(i=0;i<8;i++)
   \   00000C   7F08         MOV     R7,#0x8
    117          	{
    118          	byte <<=1;//往高位移1位
   \                     ??SHT11_Read_Byte_0:
   \   00000E   EE           MOV     A,R6
   \   00000F   C3           CLR     C
   \   000010   33           RLC     A
   \   000011   FE           MOV     R6,A
    119          	SHT11_SCL_SET;//scl=1
   \   000012   D287         SETB    0x80.7
    120          	SHT11_Delay(5);
   \   000014                ; Setup parameters for call to function SHT11_Delay
   \   000014   7905         MOV     R1,#0x5
   \   000016   12....       LCALL   ??SHT11_Delay?relay
    121          
    122          	if(SHT11_DATA)
   \   000019   A286         MOV     C,0x80.6
   \   00001B   5005         JNC     ??SHT11_Read_Byte_1
    123          		{
    124          		byte |=0x01;
   \   00001D   D3           SETB    C
   \   00001E   EE           MOV     A,R6
   \   00001F   D2E0         SETB    0xE0 /* A   */.0
   \   000021   FE           MOV     R6,A
    125          		}
    126          	SHT11_SCL_RESET;//SCL=0
   \                     ??SHT11_Read_Byte_1:
   \   000022   C287         CLR     0x80.7
    127          	}
   \   000024   1F           DEC     R7
   \   000025   EF           MOV     A,R7
   \   000026   70E6         JNZ     ??SHT11_Read_Byte_0
    128          
    129          	SHT11_DATA_OUT;//输出模式
   \   000028   43FD40       ORL     0xfd,#0x40
    130          	SHT11_DATA = !ack_status;//是否要应答
   \   00002B   E5..         MOV     A,?V0 + 0
   \   00002D   7004         JNZ     ??SHT11_Read_Byte_2
   \   00002F   7401         MOV     A,#0x1
   \   000031   8001         SJMP    ??SHT11_Read_Byte_3
   \                     ??SHT11_Read_Byte_2:
   \   000033   E4           CLR     A
   \                     ??SHT11_Read_Byte_3:
   \   000034   C4           SWAP    A
   \   000035   33           RLC     A
   \   000036   33           RLC     A
   \   000037   54C0         ANL     A,#0xc0
   \   000039   F8           MOV     R0,A
   \   00003A   E580         MOV     A,0x80
   \   00003C   54BF         ANL     A,#0xbf
   \   00003E   48           ORL     A,R0
   \   00003F   F580         MOV     0x80,A
    131          	//拉高时钟等待应答
    132          	SHT11_SCL_SET;
   \   000041   D287         SETB    0x80.7
    133          	SHT11_Delay(5);
   \   000043                ; Setup parameters for call to function SHT11_Delay
   \   000043   7905         MOV     R1,#0x5
   \   000045   12....       LCALL   ??SHT11_Delay?relay
    134          	SHT11_SCL_RESET;
   \   000048   C287         CLR     0x80.7
    135          
    136          	SHT11_DATA =1;//释放数据线
   \   00004A   D286         SETB    0x80.6
    137          	return byte;
   \   00004C   EE           MOV     A,R6
   \   00004D   F9           MOV     R1,A
   \   00004E   02....       LJMP    ?Subroutine1 & 0xFFFF
   \   000051                REQUIRE P0DIR
   \   000051                REQUIRE _A_P0
    138          }
    139          
    140          /*MODE 选择采集湿度还是温度
    141          */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    142          unsigned char SHT11_Order(unsigned char mode)
   \                     SHT11_Order:
    143          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 1,R1
    144          	unsigned char status;//success or error
    145          	unsigned char i;
    146          	unsigned char count = 0;
   \   000007   75..00       MOV     ?V0 + 0,#0x0
    147          	if(mode == MODE_TEMP)
   \   00000A   E9           MOV     A,R1
   \   00000B   7004         JNZ     ??SHT11_Order_0
    148          		{
    149          		status = SHT11_Write_Byte(SHT11_TEMP);//监测温度
   \   00000D                ; Setup parameters for call to function SHT11_Write_Byte
   \   00000D   7903         MOV     R1,#0x3
   \   00000F   8008         SJMP    ??SHT11_Order_1
    150          		}
    151          	else if(mode == MODE_HUMI)
   \                     ??SHT11_Order_0:
   \   000011   7401         MOV     A,#0x1
   \   000013   65..         XRL     A,?V0 + 1
   \   000015   7007         JNZ     ??SHT11_Order_2
    152          		{
    153          		status = SHT11_Write_Byte(SHT11_HUMI);//监测湿度
   \   000017                ; Setup parameters for call to function SHT11_Write_Byte
   \   000017   7905         MOV     R1,#0x5
   \                     ??SHT11_Order_1:
   \   000019   12....       LCALL   ??SHT11_Write_Byte?relay
   \   00001C   E9           MOV     A,R1
   \   00001D   FE           MOV     R6,A
    154          		}
    155          	if(status == SUCCESS_1)
   \                     ??SHT11_Order_2:
   \   00001E   7401         MOV     A,#0x1
   \   000020   6E           XRL     A,R6
   \   000021   701A         JNZ     ??SHT11_Order_3
    156          		{
    157          		/*写入命令成功*/
    158          		while(SHT11_DATA)
   \                     ??SHT11_Order_4:
   \   000023   A286         MOV     C,0x80.6
   \   000025   5019         JNC     ??SHT11_Order_5
    159          			{
    160          			for(i=0;i<200;i++)
   \   000027   7FC8         MOV     R7,#-0x38
    161          				{
    162          				SHT11_Delay(250);
   \                     ??SHT11_Order_6:
   \   000029                ; Setup parameters for call to function SHT11_Delay
   \   000029   12....       LCALL   ?Subroutine4 & 0xFFFF
    163          				SHT11_Delay(250);
    164          				}//100ms
   \                     ??CrossCallReturnLabel_4:
   \   00002C   1F           DEC     R7
   \   00002D   EF           MOV     A,R7
   \   00002E   70F9         JNZ     ??SHT11_Order_6
    165          				count++;
   \   000030   05..         INC     ?V0 + 0
    166          			if(count >=20)	
   \   000032   E5..         MOV     A,?V0 + 0
   \   000034   C3           CLR     C
   \   000035   9414         SUBB    A,#0x14
   \   000037   40EA         JC      ??SHT11_Order_4
    167          				{
    168          				status = ERROR;
   \   000039   7E02         MOV     R6,#0x2
    169          				break;
   \   00003B   8003         SJMP    ??SHT11_Order_5
    170          				//超过2S未响应
    171          				}
    172          			}
    173          		}
    174          	else
    175          		{
    176          		SHT11_Reset();
   \                     ??SHT11_Order_3:
   \   00003D                ; Setup parameters for call to function SHT11_Reset
   \   00003D   12....       LCALL   ??SHT11_Reset?relay
    177          		}
    178          	return status;
   \                     ??SHT11_Order_5:
   \   000040   EE           MOV     A,R6
   \   000041   F9           MOV     R1,A
   \   000042                REQUIRE ?Subroutine2
   \   000042                REQUIRE _A_P0
   \   000042                ; // Fall through to label ?Subroutine2
    179          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   7F02         MOV     R7,#0x2
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    180          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    181          void SHT11_Get_Data(void)
   \                     SHT11_Get_Data:
    182          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 2
   \   000004   74FE         MOV     A,#-0x2
   \   000006   12....       LCALL   ?ALLOC_XSTACK8
    183          	unsigned int value =0;
   \   000009   85..82       MOV     DPL,?XSP + 0
   \   00000C   85..83       MOV     DPH,?XSP + 1
   \   00000F   E4           CLR     A
   \   000010   F0           MOVX    @DPTR,A
   \   000011   A3           INC     DPTR
   \   000012   F0           MOVX    @DPTR,A
    184          	SHT11_Reset();//复位
   \   000013                ; Setup parameters for call to function SHT11_Reset
   \   000013   12....       LCALL   ??SHT11_Reset?relay
    185          	if(SHT11_Order(MODE_HUMI)==SUCCESS_1)
   \   000016                ; Setup parameters for call to function SHT11_Order
   \   000016   7901         MOV     R1,#0x1
   \   000018   12....       LCALL   ??SHT11_Order?relay
   \   00001B   E9           MOV     A,R1
   \   00001C   6401         XRL     A,#0x1
   \   00001E   7009         JNZ     ??CrossCallReturnLabel_0
    186          		{
    187          		SHT11_Delay(250);
   \   000020                ; Setup parameters for call to function SHT11_Delay
   \   000020   12....       LCALL   ?Subroutine6 & 0xFFFF
    188          		*((unsigned char *)&value+1) = SHT11_Read_Byte(ACK);//高8位
    189          		*((unsigned char *)&value) = SHT11_Read_Byte(ACK);//低8位
    190          		SHT11_Read_Byte(noACK);//校验和
    191          		}
   \                     ??CrossCallReturnLabel_7:
   \   000023   12....       LCALL   ?XSTACK_DISP0_8
   \   000026   12....       LCALL   ?Subroutine3 & 0xFFFF
    192          	SHT11.Humi = value;//记录湿度
   \                     ??CrossCallReturnLabel_0:
   \   000029   85..82       MOV     DPL,?XSP + 0
   \   00002C   85..83       MOV     DPH,?XSP + 1
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   F8           MOV     R0,A
   \   000031   A3           INC     DPTR
   \   000032   E0           MOVX    A,@DPTR
   \   000033   F9           MOV     R1,A
   \   000034   90....       MOV     DPTR,#SHT11 + 6
   \   000037   E8           MOV     A,R0
   \   000038   F0           MOVX    @DPTR,A
   \   000039   A3           INC     DPTR
   \   00003A   E9           MOV     A,R1
   \   00003B   F0           MOVX    @DPTR,A
    193          	value =0;
   \   00003C   85..82       MOV     DPL,?XSP + 0
   \   00003F   85..83       MOV     DPH,?XSP + 1
   \   000042   E4           CLR     A
   \   000043   F0           MOVX    @DPTR,A
   \   000044   A3           INC     DPTR
   \   000045   F0           MOVX    @DPTR,A
    194          	
    195          	SHT11_Reset();
   \   000046                ; Setup parameters for call to function SHT11_Reset
   \   000046   12....       LCALL   ??SHT11_Reset?relay
    196          	SHT11_Delay_Ms(200);
   \   000049                ; Setup parameters for call to function SHT11_Delay_Ms
   \   000049   79C8         MOV     R1,#-0x38
   \   00004B   12....       LCALL   ??SHT11_Delay_Ms?relay
    197          	if (SHT11_Order(MODE_TEMP)==SUCCESS_1)
   \   00004E                ; Setup parameters for call to function SHT11_Order
   \   00004E   7900         MOV     R1,#0x0
   \   000050   12....       LCALL   ??SHT11_Order?relay
   \   000053   E9           MOV     A,R1
   \   000054   6401         XRL     A,#0x1
   \   000056   7009         JNZ     ??CrossCallReturnLabel_1
    198          		{
    199          		SHT11_Delay(250);
   \   000058                ; Setup parameters for call to function SHT11_Delay
   \   000058   12....       LCALL   ?Subroutine6 & 0xFFFF
    200          		*((unsigned char *)&value+1) = SHT11_Read_Byte(ACK);//高8位
    201          		*((unsigned char *)&value) = SHT11_Read_Byte(ACK);//低8位
    202          		SHT11_Read_Byte(noACK);//校验和
    203          		}
   \                     ??CrossCallReturnLabel_8:
   \   00005B   12....       LCALL   ?XSTACK_DISP0_8
   \   00005E   12....       LCALL   ?Subroutine3 & 0xFFFF
    204          	SHT11.Temp = value;
   \                     ??CrossCallReturnLabel_1:
   \   000061   85..82       MOV     DPL,?XSP + 0
   \   000064   85..83       MOV     DPH,?XSP + 1
   \   000067   E0           MOVX    A,@DPTR
   \   000068   F8           MOV     R0,A
   \   000069   A3           INC     DPTR
   \   00006A   E0           MOVX    A,@DPTR
   \   00006B   F9           MOV     R1,A
   \   00006C   90....       MOV     DPTR,#SHT11 + 4
   \   00006F   E8           MOV     A,R0
   \   000070   F0           MOVX    @DPTR,A
   \   000071   A3           INC     DPTR
   \   000072   E9           MOV     A,R1
   \   000073   F0           MOVX    @DPTR,A
    205          }
   \   000074   7402         MOV     A,#0x2
   \   000076   12....       LCALL   ?DEALLOC_XSTACK8
   \   000079   02....       LJMP    ?Subroutine0 & 0xFFFF

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   79FA         MOV     R1,#-0x6
   \   000002   12....       LCALL   ??SHT11_Delay?relay
   \   000005                ; Setup parameters for call to function SHT11_Read_Byte
   \   000005                ; Setup parameters for call to function SHT11_Read_Byte
   \   000005   7901         MOV     R1,#0x1
   \   000007   12....       LCALL   ??SHT11_Read_Byte?relay
   \   00000A   7401         MOV     A,#0x1
   \   00000C   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   E9           MOV     A,R1
   \   000001   F0           MOVX    @DPTR,A
   \   000002                ; Setup parameters for call to function SHT11_Read_Byte
   \   000002                ; Setup parameters for call to function SHT11_Read_Byte
   \   000002   7901         MOV     R1,#0x1
   \   000004   12....       LCALL   ??SHT11_Read_Byte?relay
   \   000007   E9           MOV     A,R1
   \   000008   85..82       MOV     DPL,?XSP + 0
   \   00000B   85..83       MOV     DPH,?XSP + 1
   \   00000E   F0           MOVX    @DPTR,A
   \   00000F                ; Setup parameters for call to function SHT11_Read_Byte
   \   00000F                ; Setup parameters for call to function SHT11_Read_Byte
   \   00000F   7900         MOV     R1,#0x0
   \   000011   12....       LCALL   ??SHT11_Read_Byte?relay
   \   000014   22           RET
    206          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    207          void SHT11_Real_Data(void)
   \                     SHT11_Real_Data:
    208          {
   \   000000   74E8         MOV     A,#-0x18
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 24
   \   000005                ; Auto size: 0
    209          	SHT11_Get_Data();//获取到温度和湿度数据
   \   000005                ; Setup parameters for call to function SHT11_Get_Data
   \   000005   12....       LCALL   ??SHT11_Get_Data?relay
    210          	const float C1 = -2.0468;//
    211          	const float C2 = +0.0367;
    212          	const float C3 = -0.0000015955;
    213          	const float T1 = +0.01;
    214          	const float T2 = +0.00008;
    215          
    216          	float rh = SHT11.Humi;//12位湿度
   \   000008   90....       MOV     DPTR,#SHT11 + 6
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   F5..         MOV     ?V0 + 4,A
   \   00000E   A3           INC     DPTR
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   F5..         MOV     ?V0 + 5,A
   \   000012   33           RLC     A
   \   000013   95E0         SUBB    A,0xE0 /* A   */
   \   000015   F5..         MOV     ?V0 + 6,A
   \   000017   F5..         MOV     ?V0 + 7,A
   \   000019   78..         MOV     R0,#?V0 + 4
   \   00001B   12....       LCALL   ?L_TO_FLT
    217          	float t = SHT11.Temp;//14为温度
    218          	float rh_lin;//温度极限值
    219          	float rh_true;//真实值
    220          	float t_C;
    221          
    222          	//t_C = t*0.01-40.1;//供电电压5V
    223                  t_C = t*0.01-39.6;//供电电压3.3V
   \   00001E   90....       MOV     DPTR,#SHT11 + 4
   \   000021   E0           MOVX    A,@DPTR
   \   000022   F5..         MOV     ?V0 + 8,A
   \   000024   A3           INC     DPTR
   \   000025   E0           MOVX    A,@DPTR
   \   000026   F5..         MOV     ?V0 + 9,A
   \   000028   33           RLC     A
   \   000029   95E0         SUBB    A,0xE0 /* A   */
   \   00002B   F5..         MOV     ?V0 + 10,A
   \   00002D   F5..         MOV     ?V0 + 11,A
   \   00002F   78..         MOV     R0,#?V0 + 8
   \   000031   12....       LCALL   ?L_TO_FLT
   \   000034   90....       MOV     DPTR,#__Constant_3c23d70a
   \   000037   78..         MOV     R0,#?V0 + 0
   \   000039   12....       LCALL   ?L_MOV_X
   \   00003C   78..         MOV     R0,#?V0 + 8
   \   00003E   79..         MOV     R1,#?V0 + 0
   \   000040   12....       LCALL   ?FLT_MUL
   \   000043   90....       MOV     DPTR,#__Constant_c21e6666
   \   000046   78..         MOV     R0,#?V0 + 0
   \   000048   12....       LCALL   ?L_MOV_X
   \   00004B   78..         MOV     R0,#?V0 + 8
   \   00004D   79..         MOV     R1,#?V0 + 0
   \   00004F   12....       LCALL   ?FLT_ADD
    224                  if(t_C<15)
   \   000052   90....       MOV     DPTR,#__Constant_41700000
   \   000055   78..         MOV     R0,#?V0 + 0
   \   000057   12....       LCALL   ?L_MOV_X
   \   00005A   78..         MOV     R0,#?V0 + 8
   \   00005C   79..         MOV     R1,#?V0 + 0
   \   00005E   12....       LCALL   ?FLT_LT
   \   000061   5008         JNC     ??SHT11_Real_Data_0
    225                    t_C=0;
   \   000063   90....       MOV     DPTR,#__Constant_0
   \   000066   78..         MOV     R0,#?V0 + 8
   \   000068   12....       LCALL   ?L_MOV_X
    226                  else
    227                    t_C=t_C;
    228          	rh_lin = C3*rh*rh+C2*rh+C1;//相对湿度补偿
    229          	rh_true=(t_C-25)*(T1+T2*rh)+rh_lin;//相对湿度补偿
   \                     ??SHT11_Real_Data_0:
   \   00006B   85....       MOV     ?V0 + 0,?V0 + 8
   \   00006E   85....       MOV     ?V0 + 1,?V0 + 9
   \   000071   85....       MOV     ?V0 + 2,?V0 + 10
   \   000074   85....       MOV     ?V0 + 3,?V0 + 11
   \   000077   90....       MOV     DPTR,#__Constant_c1c80000
   \   00007A   78..         MOV     R0,#?V0 + 12
   \   00007C   12....       LCALL   ?L_MOV_X
   \   00007F   78..         MOV     R0,#?V0 + 0
   \   000081   79..         MOV     R1,#?V0 + 12
   \   000083   12....       LCALL   ?FLT_ADD
   \   000086   C0..         PUSH    ?V0 + 0
   \   000088   C0..         PUSH    ?V0 + 1
   \   00008A   C0..         PUSH    ?V0 + 2
   \   00008C   C0..         PUSH    ?V0 + 3
   \   00008E   85....       MOV     ?V0 + 0,?V0 + 4
   \   000091   85....       MOV     ?V0 + 1,?V0 + 5
   \   000094   85....       MOV     ?V0 + 2,?V0 + 6
   \   000097   85....       MOV     ?V0 + 3,?V0 + 7
   \   00009A   90....       MOV     DPTR,#__Constant_38a7c5ac
   \   00009D   78..         MOV     R0,#?V0 + 12
   \   00009F   12....       LCALL   ?L_MOV_X
   \   0000A2   78..         MOV     R0,#?V0 + 0
   \   0000A4   79..         MOV     R1,#?V0 + 12
   \   0000A6   12....       LCALL   ?FLT_MUL
   \   0000A9   90....       MOV     DPTR,#__Constant_3c23d70a
   \   0000AC   78..         MOV     R0,#?V0 + 12
   \   0000AE   12....       LCALL   ?L_MOV_X
   \   0000B1   78..         MOV     R0,#?V0 + 0
   \   0000B3   79..         MOV     R1,#?V0 + 12
   \   0000B5   12....       LCALL   ?FLT_ADD
   \   0000B8   D0..         POP     ?V0 + 15
   \   0000BA   D0..         POP     ?V0 + 14
   \   0000BC   D0..         POP     ?V0 + 13
   \   0000BE   D0..         POP     ?V0 + 12
   \   0000C0   78..         MOV     R0,#?V0 + 12
   \   0000C2   79..         MOV     R1,#?V0 + 0
   \   0000C4   12....       LCALL   ?FLT_MUL
   \   0000C7   C0..         PUSH    ?V0 + 12
   \   0000C9   C0..         PUSH    ?V0 + 13
   \   0000CB   C0..         PUSH    ?V0 + 14
   \   0000CD   C0..         PUSH    ?V0 + 15
   \   0000CF   85....       MOV     ?V0 + 0,?V0 + 4
   \   0000D2   85....       MOV     ?V0 + 1,?V0 + 5
   \   0000D5   85....       MOV     ?V0 + 2,?V0 + 6
   \   0000D8   85....       MOV     ?V0 + 3,?V0 + 7
   \   0000DB   90....       MOV     DPTR,#__Constant_b5d624f6
   \   0000DE   78..         MOV     R0,#?V0 + 12
   \   0000E0   12....       LCALL   ?L_MOV_X
   \   0000E3   78..         MOV     R0,#?V0 + 0
   \   0000E5   79..         MOV     R1,#?V0 + 12
   \   0000E7   12....       LCALL   ?FLT_MUL
   \   0000EA   78..         MOV     R0,#?V0 + 0
   \   0000EC   79..         MOV     R1,#?V0 + 4
   \   0000EE   12....       LCALL   ?FLT_MUL
   \   0000F1   90....       MOV     DPTR,#__Constant_3d1652bd
   \   0000F4   78..         MOV     R0,#?V0 + 12
   \   0000F6   12....       LCALL   ?L_MOV_X
   \   0000F9   78..         MOV     R0,#?V0 + 4
   \   0000FB   79..         MOV     R1,#?V0 + 12
   \   0000FD   12....       LCALL   ?FLT_MUL
   \   000100   78..         MOV     R0,#?V0 + 0
   \   000102   79..         MOV     R1,#?V0 + 4
   \   000104   12....       LCALL   ?FLT_ADD
   \   000107   90....       MOV     DPTR,#__Constant_c002fec5
   \   00010A   78..         MOV     R0,#?V0 + 4
   \   00010C   12....       LCALL   ?L_MOV_X
   \   00010F   78..         MOV     R0,#?V0 + 0
   \   000111   79..         MOV     R1,#?V0 + 4
   \   000113   12....       LCALL   ?FLT_ADD
   \   000116   D0..         POP     ?V0 + 7
   \   000118   D0..         POP     ?V0 + 6
   \   00011A   D0..         POP     ?V0 + 5
   \   00011C   D0..         POP     ?V0 + 4
   \   00011E   78..         MOV     R0,#?V0 + 4
   \   000120   79..         MOV     R1,#?V0 + 0
   \   000122   12....       LCALL   ?FLT_ADD
    230          	if(rh_true>100)
   \   000125   90....       MOV     DPTR,#__Constant_42c80001
   \   000128   78..         MOV     R0,#?V0 + 0
   \   00012A   12....       LCALL   ?L_MOV_X
   \   00012D   78..         MOV     R0,#?V0 + 4
   \   00012F   79..         MOV     R1,#?V0 + 0
   \   000131   12....       LCALL   ?FLT_GE
   \   000134   5005         JNC     ??SHT11_Real_Data_1
    231          		rh_true=100;
   \   000136   90....       MOV     DPTR,#__Constant_42c80000
   \   000139   8014         SJMP    ??SHT11_Real_Data_2
    232          	if(rh_true<0.1)
   \                     ??SHT11_Real_Data_1:
   \   00013B   90....       MOV     DPTR,#__Constant_3dcccccd
   \   00013E   78..         MOV     R0,#?V0 + 0
   \   000140   12....       LCALL   ?L_MOV_X
   \   000143   78..         MOV     R0,#?V0 + 4
   \   000145   79..         MOV     R1,#?V0 + 0
   \   000147   12....       LCALL   ?FLT_LT
   \   00014A   5008         JNC     ??SHT11_Real_Data_3
    233          		rh_true=0.1;
   \   00014C   90....       MOV     DPTR,#__Constant_3dcccccd
   \                     ??SHT11_Real_Data_2:
   \   00014F   78..         MOV     R0,#?V0 + 4
   \   000151   12....       LCALL   ?L_MOV_X
    234          	#ifndef SHT11_DATA_FLOAT
    235          	SHT11.Temp = (int)t_C;//返回温度
   \                     ??SHT11_Real_Data_3:
   \   000154   78..         MOV     R0,#?V0 + 8
   \   000156   12....       LCALL   ?FLT_TO_L
   \   000159   90....       MOV     DPTR,#SHT11 + 4
   \   00015C   E5..         MOV     A,?V0 + 8
   \   00015E   F0           MOVX    @DPTR,A
   \   00015F   A3           INC     DPTR
   \   000160   E5..         MOV     A,?V0 + 9
   \   000162   F0           MOVX    @DPTR,A
    236          	SHT11.Humi = (int)rh_true;//返回湿度
   \   000163   78..         MOV     R0,#?V0 + 4
   \   000165   12....       LCALL   ?FLT_TO_L
   \   000168   A3           INC     DPTR
   \   000169   E5..         MOV     A,?V0 + 4
   \   00016B   F0           MOVX    @DPTR,A
   \   00016C   A3           INC     DPTR
   \   00016D   E5..         MOV     A,?V0 + 5
   \   00016F   F0           MOVX    @DPTR,A
    237          	#else
    238          	SHT11.Temp = t_C;  //返回温度
    239          	SHT11.Humi = rh_true;//返回湿度
    240          	#endif
    241          	
    242          }
   \   000170   7F10         MOV     R7,#0x10
   \   000172   02....       LJMP    ?BANKED_LEAVE_XDATA
    243          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    244          void SHT11_Finish(void)
   \                     SHT11_Finish:
    245          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    246          #ifdef SHT11_DATA_FLOAT
    247          	unsigned int temp;//中间变量
    248          #endif
    249          	if(flag == 0)
   \   000005   90....       MOV     DPTR,#flag
   \   000008   E0           MOVX    A,@DPTR
   \   000009   7009         JNZ     ??SHT11_Finish_0
    250          		{
    251                          //执行一次初始化
    252          		SHT11_Init();
   \   00000B   53F33F       ANL     0xf3,#0x3f
   \   00000E   43FDC0       ORL     0xfd,#0xc0
    253          		flag =1;
   \   000011   7401         MOV     A,#0x1
   \   000013   F0           MOVX    @DPTR,A
    254          		}
    255          	SHT11_Real_Data();//获取数据
   \                     ??SHT11_Finish_0:
   \   000014                ; Setup parameters for call to function SHT11_Real_Data
   \   000014   12....       LCALL   ??SHT11_Real_Data?relay
    256          	SHT11_Delay_Ms(100);
   \   000017                ; Setup parameters for call to function SHT11_Delay_Ms
   \   000017   7964         MOV     R1,#0x64
   \   000019   12....       LCALL   ??SHT11_Delay_Ms?relay
    257          #ifndef SHT11_DATA_FLOAT
    258          /*--------温度转换字节------------*/
    259          #ifdef SHT11_DATA_BYTE
    260                SHT11.Temp_byte[0]=(SHT11.Temp>>8)&0xff;
   \   00001C   90....       MOV     DPTR,#SHT11 + 4
   \   00001F   12....       LCALL   ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_5:
   \   000022   12....       LCALL   ?SS_SHR
   \   000025   E5..         MOV     A,?V0 + 0
   \   000027   90....       MOV     DPTR,#SHT11
   \   00002A   F0           MOVX    @DPTR,A
    261                SHT11.Temp_byte[1]=SHT11.Temp&0xff;
   \   00002B   90....       MOV     DPTR,#SHT11 + 4
   \   00002E   E0           MOVX    A,@DPTR
   \   00002F   90....       MOV     DPTR,#SHT11 + 1
   \   000032   F0           MOVX    @DPTR,A
    262          #else
    263          /*--------温度转换字符------------*/
    264          if(SHT11.Temp/100 !=0)
    265          	{
    266          	SHT11.Temp_s[0]=SHT11.Temp/100+0x30;//百位
    267          	SHT11.Temp_s[1]=SHT11.Temp%100/10+0x30;
    268          	SHT11.Temp_s[2]=SHT11.Temp%10+0x30;
    269          	SHT11.Temp_s[3]='\0';
    270          	SHT11.length_temp=3;
    271          	}
    272          else
    273          	{
    274          	if(SHT11.Temp%100/10 !=0)//十位不为0
    275          		{
    276          		SHT11.Temp_s[0]=SHT11.Temp/10+0x30;//十位
    277          		SHT11.Temp_s[1]=SHT11.Temp%10+0x30;//个位
    278          		SHT11.Temp_s[2]='\0';
    279          		SHT11.length_temp=2;
    280          		}
    281          	else
    282          		{
    283          		SHT11.Temp_s[0]=SHT11.Temp+0x30;//个位
    284          		SHT11.Temp_s[1]='\0';
    285          		SHT11.length_temp=1;
    286          		}
    287          	
    288          	}
    289          #endif
    290          /*--------湿度转换字节------------*/
    291          #ifdef SHT11_DATA_BYTE
    292                SHT11.Humi_byte[0]=(SHT11.Humi>>8)&0xff;
   \   000033   90....       MOV     DPTR,#SHT11 + 6
   \   000036   12....       LCALL   ?Subroutine5 & 0xFFFF
   \                     ??CrossCallReturnLabel_6:
   \   000039   12....       LCALL   ?SS_SHR
   \   00003C   E5..         MOV     A,?V0 + 0
   \   00003E   90....       MOV     DPTR,#SHT11 + 2
   \   000041   F0           MOVX    @DPTR,A
    293                SHT11.Humi_byte[1]=SHT11.Humi&0xff;
   \   000042   90....       MOV     DPTR,#SHT11 + 6
   \   000045   E0           MOVX    A,@DPTR
   \   000046   90....       MOV     DPTR,#SHT11 + 3
   \   000049   F0           MOVX    @DPTR,A
    294          #else
    295          /*--------------湿度转换字符串-------------*/
    296          	if(SHT11.Humi/100 !=0)
    297          		{
    298          			SHT11.Humi_s[0]=SHT11.Humi/100+0x30;//百位
    299          			SHT11.Humi_s[1]=SHT11.Humi%100/10+0x30;
    300          			SHT11.Humi_s[2]=SHT11.Humi%10+0x30;
    301          			SHT11.Humi_s[3]='\0';
    302          			SHT11.length_humi=3;
    303          		}
    304          	else
    305          		{
    306          			if(SHT11.Humi%100/10 !=0)
    307          				{
    308          				SHT11.Humi_s[0]=SHT11.Humi/10+0x30;
    309          				SHT11.Humi_s[1]=SHT11.Humi%10+0x30;
    310          				SHT11.Humi_s[3]='\0';
    311          				SHT11.length_humi=2;
    312          				}
    313          			else
    314          				{
    315          				SHT11.Humi_s[0]=SHT11.Humi+0X30;
    316          				SHT11.Humi_s[1]='\0';
    317          				SHT11.length_humi=1;
    318          				}
    319          		}
    320          #endif
    321          #else
    322          //开启了精度，记录了小数点数值
    323          /*--------温度转换字符------------*/
    324          	temp = (unsigned int)(SHT11.Temp*10);//记录小数点下一位
    325          #ifdef SHT11_DATA_BYTE
    326                  SHT11.Temp_byte[0]=(temp>>8)&0xff;
    327                  SHT11.Temp_byte[1]=temp&0xff;
    328          #else
    329          	if(temp/1000 !=0)//百位不为0
    330          		{
    331          		SHT11.Temp_s[0]=temp/1000+0x30;//百位
    332          		SHT11.Temp_s[1]=temp%1000/100+0x30;//十位
    333          		SHT11.Temp_s[2]=temp%100/10+0x30;//个位
    334          		SHT11.Temp_s[3]=0x2E;
    335          		SHT11.Temp_s[4]=temp%10+0x30;//小数后一位
    336          		SHT11.Temp_s[5]='\0';
    337          		SHT11.length_temp=5;
    338          		}
    339          	else
    340          	{
    341          		if(temp/100 !=0)//十位不为0
    342          		{
    343          		SHT11.Temp_s[0]=temp/100+0x30;//十位
    344          		SHT11.Temp_s[1]=temp%100/10+0x30;//个位
    345          		SHT11.Temp_s[2]=0x2E;
    346          		SHT11.Temp_s[3]=temp%10+0x30;//小数后一位
    347          		SHT11.Temp_s[4]='\0';
    348          		SHT11.length_temp=4;
    349          		}
    350          		else
    351          		{
    352          		SHT11.Temp_s[0]=temp/10+0x30;//个位
    353          		SHT11.Temp_s[1]=0x2E;
    354          		SHT11.Temp_s[2]=temp%10+0x30;//小数后一位
    355          		SHT11.Temp_s[3]='\0';
    356          		SHT11.length_temp=3;
    357          		}
    358          	}
    359          #endif
    360          /*--------------湿度转换字符串-------------*/
    361          	temp=(unsigned int)(SHT11.Humi*10);
    362          #ifdef SHT11_DATA_BYTE
    363                  SHT11.Humi_byte[0]=(temp>>8)&0xff;
    364                  SHT11.Humi_byte[1]=temp&0xff;
    365          #else
    366          	if(temp/1000 !=0)
    367          		{
    368          		SHT11.Humi_s[0]=temp/1000+0x30;//百位
    369          		SHT11.Humi_s[1]=temp%1000/100+0x30;//十位
    370          		SHT11.Humi_s[2]=temp%100/10+0x30;//个位
    371          		SHT11.Humi_s[3]=0x2E;
    372          		SHT11.Humi_s[4]=temp%10+0x30;//小数后一位
    373          		SHT11.Humi_s[5]='\0';
    374          		SHT11.length_humi=5;
    375          		}
    376          	else
    377          		{
    378          		if(temp/100 !=0)//十位不为0
    379          			{
    380          			SHT11.Humi_s[0]=temp/100+0x30;//十位
    381          			SHT11.Humi_s[1]=temp%100/10+0x30;//个位
    382          			SHT11.Humi_s[2]=0x2E;
    383          			SHT11.Humi_s[3]=temp%10+0x30;//小数后一位
    384          			SHT11.Humi_s[4]='\0';
    385          			SHT11.length_humi=4;
    386          			}
    387          		else
    388          			{
    389          			SHT11.Humi_s[0]=temp/10+0x30;//个位
    390          			SHT11.Humi_s[1]=0x2E;
    391          			SHT11.Humi_s[2]=temp%10+0x30;//小数后一位
    392          			SHT11.Humi_s[3]='\0';
    393          			SHT11.length_humi=3;
    394          			}
    395          		}
    396          #endif
    397          #endif
    398          }
   \   00004A   02....       LJMP    ?Subroutine2 & 0xFFFF
   \   00004D                REQUIRE P0SEL
   \   00004D                REQUIRE P0DIR

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F5..         MOV     ?V0 + 0,A
   \   000003   A3           INC     DPTR
   \   000004   E0           MOVX    A,@DPTR
   \   000005   F5..         MOV     ?V0 + 1,A
   \   000007   7408         MOV     A,#0x8
   \   000009   78..         MOV     R0,#?V0 + 0
   \   00000B   22           RET

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3c23d70a:
   \   000000   0AD7233C     DD 3C23D70AH

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_c21e6666:
   \   000000   66661EC2     DD 0C21E6666H

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_41700000:
   \   000000   00007041     DD 41700000H

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_0:
   \   000000   00000000     DD 0H

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_c1c80000:
   \   000000   0000C8C1     DD 0C1C80000H

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_38a7c5ac:
   \   000000   ACC5A738     DD 38A7C5ACH

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_b5d624f6:
   \   000000   F624D6B5     DD 0B5D624F6H

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3d1652bd:
   \   000000   BD52163D     DD 3D1652BDH

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_c002fec5:
   \   000000   C5FE02C0     DD 0C002FEC5H

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_42c80001:
   \   000000   0100C842     DD 42C80001H

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_42c80000:
   \   000000   0000C842     DD 42C80000H

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_3dcccccd:
   \   000000   CDCCCC3D     DD 3DCCCCCDH

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Delay?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Delay

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Delay_Ms?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Delay_Ms

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Start?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Start

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Reset?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Reset

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Write_Byte?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Write_Byte

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Read_Byte?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Read_Byte

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Order?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Order

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Get_Data?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Get_Data

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Real_Data?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Real_Data

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SHT11_Finish?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SHT11_Finish

   Maximum stack usage in bytes:

     Function              ISTACK PSTACK XSTACK
     --------              ------ ------ ------
     SHT11_Delay               0      0     10
     SHT11_Delay_Ms            0      0     19
       -> SHT11_Delay          0      0     18
       -> SHT11_Delay          0      0     18
       -> SHT11_Delay          0      0     18
       -> SHT11_Delay          0      0     18
     SHT11_Finish              0      0     10
       -> SHT11_Real_Data      0      0     20
       -> SHT11_Delay_Ms       0      0     20
     SHT11_Get_Data            3      0     26
       -> SHT11_Reset          4      0      4
       -> SHT11_Order          4      0      4
       -> SHT11_Delay          4      0      4
       -> SHT11_Read_Byte      4      0      4
       -> SHT11_Read_Byte      4      0      4
       -> SHT11_Read_Byte      4      0      4
       -> SHT11_Reset          4      0      4
       -> SHT11_Delay_Ms       4      0      4
       -> SHT11_Order          4      0      4
       -> SHT11_Delay          4      0      4
       -> SHT11_Read_Byte      4      0      4
       -> SHT11_Read_Byte      4      0      4
       -> SHT11_Read_Byte      4      0      4
     SHT11_Order               0      0     12
       -> SHT11_Write_Byte     0      0     20
       -> SHT11_Write_Byte     0      0     20
       -> SHT11_Delay          0      0     20
       -> SHT11_Delay          0      0     20
       -> SHT11_Reset          0      0     20
     SHT11_Read_Byte           0      0     11
       -> SHT11_Delay          0      0     18
       -> SHT11_Delay          0      0     18
     SHT11_Real_Data           4      0     34
       -> SHT11_Get_Data       0      0     48
     SHT11_Reset               2      0     10
       -> SHT11_Start          4      0      0
     SHT11_Start               2      0      0
       -> SHT11_Delay          4      0      0
       -> SHT11_Delay          4      0      0
       -> SHT11_Delay          4      0      0
     SHT11_Write_Byte          0      0     19
       -> SHT11_Delay          0      0     18


   Segment part sizes:

     Function/Label           Bytes
     --------------           -----
     _A_P0                       1
     P0SEL                       1
     P0DIR                       1
     SHT11                      18
     flag                        1
     SHT11_Delay                22
     SHT11_Delay_Ms             23
     ?Subroutine1                5
     ?Subroutine4               11
     SHT11_Start                38
     ?Subroutine0                7
     SHT11_Reset                29
     SHT11_Write_Byte           64
     SHT11_Read_Byte            81
     SHT11_Order                66
     ?Subroutine2                5
     SHT11_Get_Data            124
     ?Subroutine6               13
     ?Subroutine3               21
     SHT11_Real_Data           373
     SHT11_Finish               77
     ?Subroutine5               12
     __Constant_3c23d70a         4
     __Constant_c21e6666         4
     __Constant_41700000         4
     __Constant_0                4
     __Constant_c1c80000         4
     __Constant_38a7c5ac         4
     __Constant_b5d624f6         4
     __Constant_3d1652bd         4
     __Constant_c002fec5         4
     __Constant_42c80001         4
     __Constant_42c80000         4
     __Constant_3dcccccd         4
     ??SHT11_Delay?relay         6
     ??SHT11_Delay_Ms?relay      6
     ??SHT11_Start?relay         6
     ??SHT11_Reset?relay         6
     ??SHT11_Write_Byte?relay    6
     ??SHT11_Read_Byte?relay     6
     ??SHT11_Order?relay         6
     ??SHT11_Get_Data?relay      6
     ??SHT11_Real_Data?relay     6
     ??SHT11_Finish?relay        6

 
 971 bytes in segment BANKED_CODE
  60 bytes in segment BANK_RELAYS
   3 bytes in segment SFR_AN
  48 bytes in segment XDATA_ROM_C
  19 bytes in segment XDATA_Z
 
 1 031 bytes of CODE  memory
     0 bytes of CONST memory (+ 48 bytes shared)
     0 bytes of DATA  memory (+  3 bytes shared)
    19 bytes of XDATA memory

Errors: none
Warnings: none
